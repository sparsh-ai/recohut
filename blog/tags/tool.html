<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">2 posts tagged with &quot;tool&quot; | Recohut Data Bootcamp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.recohut.com/blog/tags/tool"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="data science, data engineering, data analytics"><meta data-rh="true" property="og:title" content="2 posts tagged with &quot;tool&quot; | Recohut Data Bootcamp"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/branding/favicon-black.svg"><link data-rh="true" rel="canonical" href="https://www.recohut.com/blog/tags/tool"><link data-rh="true" rel="alternate" href="https://www.recohut.com/blog/tags/tool" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.recohut.com/blog/tags/tool" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recohut Data Bootcamp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recohut Data Bootcamp Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B4S1B1ZDTT"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B4S1B1ZDTT",{})</script><link rel="stylesheet" href="/assets/css/styles.099cbecb.css">
<link rel="preload" href="/assets/js/runtime~main.1db50233.js" as="script">
<link rel="preload" href="/assets/js/main.c578965a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/branding/favicon-color.svg" alt="Recohut Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Bootcamp</b></a><a class="navbar__item navbar__link" href="/docs/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/recohut" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/12/24/ab-mab-tests">A/B and Multi-Armed Bandit Tests</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/12/13/sql-to-snowflake-schema-conversion">SQL Server to Snowflake Schema Conversion</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/12/12/the-complete-python-course-2022">The Complete Python Course (2022)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2022/11/16/opening-material">Opening our Bootcamp material</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2021/10/01/clinical-decision-making">Clinical Decision Making</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>2 posts tagged with &quot;tool&quot;</h1><a href="/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/10/01/detectron-2">Detectron 2</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/sparsh-ai.png" alt="Sparsh Agarwal"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Data Scientist &amp; Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-1b615c35cb13ff3ee0b6a399bde1a3c7.png" width="1347" height="901" class="img_ev3q"></p><h1>Introduction</h1><p>Detectron 2 is a next-generation open-source object detection system from Facebook AI Research. With the repo you can use and train the various state-of-the-art models for detection tasks such as bounding-box detection, instance and semantic segmentation, and person keypoint detection.</p><p>The following is the directory tree of detectron 2:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">detectron2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─checkpoint  &lt;- checkpointer and model catalog handlers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─config      &lt;- default configs and handlers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─data        &lt;- dataset handlers and data loaders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─engine      &lt;- predictor and trainer engines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─evaluation  &lt;- evaluator for each dataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─export      &lt;- converter of detectron2 models to caffe2 (ONNX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─layers      &lt;- custom layers e.g. deformable conv.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─model_zoo   &lt;- pre-trained model links and handler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─modeling   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─meta_arch &lt;- meta architecture e.g. R-CNN, RetinaNet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─backbone  &lt;- backbone network e.g. ResNet, FPN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─proposal_generator &lt;- region proposal network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─roi_heads &lt;- head networks for pooled ROIs e.g. box, mask heads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─solver       &lt;- optimizer and scheduler builders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─structures   &lt;- structure classes e.g. Boxes, Instances, etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─utils        &lt;- utility modules e.g. visualizer, logger, etc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Installation</h1><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">%</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">U torch</span><span class="token operator" style="color:#393A34">==</span><span class="token number" style="color:#36acaa">1.4</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">cu100 torchvision</span><span class="token operator" style="color:#393A34">==</span><span class="token number" style="color:#36acaa">0.5</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">cu100 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">f https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">download</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pytorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">whl</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">torch_stable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">html</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install cython pyyaml</span><span class="token operator" style="color:#393A34">==</span><span class="token number" style="color:#36acaa">5.1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">U </span><span class="token string" style="color:#e3116c">&#x27;git+https://github.com/cocodataset/cocoapi.git#subdirectory=PythonAPI&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install detectron2 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">f https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">dl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fbaipublicfiles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">detectron2</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">wheels</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cu100</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">html</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> detectron2 </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> model_zoo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> detectron2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">engine </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> DefaultPredictor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> detectron2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">config </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> detectron2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">visualizer </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Visualizer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> detectron2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MetadataCatalog</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Inference on pre-trained models</h1><p><img loading="lazy" alt="Original image" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-1-f67813931f498e5451c89d34fc53c18a.png" width="620" height="479" class="img_ev3q"></p><p>Original image</p><p><img loading="lazy" alt="Object detection with Faster-RCNN-101" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-2-2d53fa263a2f78ba53e25191a5174f6a.png" width="744" height="574" class="img_ev3q"></p><p>Object detection with Faster-RCNN-101</p><p><img loading="lazy" alt="Instance segmentation with Mask-RCNN-50" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-3-843f187808ce30f5f39ee16632bcc07e.png" width="744" height="574" class="img_ev3q"></p><p>Instance segmentation with Mask-RCNN-50</p><p><img loading="lazy" alt="Keypoint estimation with Keypoint-RCNN-50" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-4-dc55d3ff169a8b338c25147d005a7357.png" width="744" height="574" class="img_ev3q"></p><p>Keypoint estimation with Keypoint-RCNN-50</p><p><img loading="lazy" alt="Panoptic segmentation with Panoptic-FPN-101" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-5-400fd835e75e14ba61644847b378b47f.png" width="744" height="574" class="img_ev3q"></p><p>Panoptic segmentation with Panoptic-FPN-101</p><p><img loading="lazy" alt="Default Mask R-CNN (top) vs. Mask R-CNN with PointRend (bottom) comparison" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-6-9497a38e9bed29af766a327244331cee.png" width="744" height="1148" class="img_ev3q"></p><p>Default Mask R-CNN (top) vs. Mask R-CNN with PointRend (bottom) comparison</p><h1>Fine-tuning Balloons Dataset</h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-the-data">Load the data<a class="hash-link" href="#load-the-data" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># download, decompress the data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!wget https://github.com/matterport/Mask_RCNN/releases/download/v2.1/balloon_dataset.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!unzip balloon_dataset.zip &gt; /dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="convert-dataset-into-detectron2s-standard-format">Convert dataset into Detectron2&#x27;s standard format<a class="hash-link" href="#convert-dataset-into-detectron2s-standard-format" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from detectron2.structures import BoxMode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># write a function that loads the dataset into detectron2&#x27;s standard format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def get_balloon_dicts(img_dir):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    json_file = os.path.join(img_dir, &quot;via_region_data.json&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    with open(json_file) as f:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        imgs_anns = json.load(f)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataset_dicts = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for _, v in imgs_anns.items():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        filename = os.path.join(img_dir, v[&quot;filename&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        height, width = cv2.imread(filename).shape[:2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;file_name&quot;] = filename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;height&quot;] = height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;width&quot;] = width</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        annos = v[&quot;regions&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        objs = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for _, anno in annos.items():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            assert not anno[&quot;region_attributes&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            anno = anno[&quot;shape_attributes&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            px = anno[&quot;all_points_x&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            py = anno[&quot;all_points_y&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            poly = [(x + 0.5, y + 0.5) for x, y in zip(px, py)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            poly = list(itertools.chain.from_iterable(poly))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            obj = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;bbox&quot;: [np.min(px), np.min(py), np.max(px), np.max(py)],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;bbox_mode&quot;: BoxMode.XYXY_ABS,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;segmentation&quot;: [poly],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;category_id&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;iscrowd&quot;: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            objs.append(obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;annotations&quot;] = objs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dataset_dicts.append(record)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return dataset_dicts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from detectron2.data import DatasetCatalog, MetadataCatalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for d in [&quot;train&quot;, &quot;val&quot;]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DatasetCatalog.register(&quot;balloon/&quot; + d, lambda d=d: get_balloon_dicts(&quot;balloon/&quot; + d))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MetadataCatalog.get(&quot;balloon/&quot; + d).set(thing_classes=[&quot;balloon&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">balloon_metadata = MetadataCatalog.get(&quot;balloon/train&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="model-configuration-and-training">Model configuration and training<a class="hash-link" href="#model-configuration-and-training" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from detectron2.engine import DefaultTrainer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from detectron2.config import get_cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg = get_cfg()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.merge_from_file(model_zoo.get_config_file(&quot;COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x.yaml&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATASETS.TRAIN = (&quot;balloon/train&quot;,)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATASETS.TEST = ()   # no metrics implemented for this dataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATALOADER.NUM_WORKERS = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.WEIGHTS = model_zoo.get_checkpoint_url(&quot;COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x.yaml&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.SOLVER.IMS_PER_BATCH = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.SOLVER.BASE_LR = 0.00025</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.SOLVER.MAX_ITER = 300    # 300 iterations seems good enough, but you can certainly train longer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.ROI_HEADS.BATCH_SIZE_PER_IMAGE = 128   # faster, and good enough for this toy dataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.ROI_HEADS.NUM_CLASSES = 1  # only has one class (ballon)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.makedirs(cfg.OUTPUT_DIR, exist_ok=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer = DefaultTrainer(cfg) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer.resume_or_load(resume=False)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer.train()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inference-and-visualization">Inference and Visualization<a class="hash-link" href="#inference-and-visualization" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from detectron2.utils.visualizer import ColorMode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># load weights</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.WEIGHTS = os.path.join(cfg.OUTPUT_DIR, &quot;model_final.pth&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.ROI_HEADS.SCORE_THRESH_TEST = 0.7   # set the testing threshold for this model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set training data-set path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATASETS.TEST = (&quot;balloon/val&quot;, )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create predictor (model for inference)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">predictor = DefaultPredictor(cfg)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset_dicts = get_balloon_dicts(&quot;balloon/val&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for d in random.sample(dataset_dicts, 3):    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    im = cv2.imread(d[&quot;file_name&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    outputs = predictor(im)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v = Visualizer(im[:, :, ::-1],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   metadata=balloon_metadata, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   scale=0.8, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   instance_mode=ColorMode.IMAGE_BW   # remove the colors of unsegmented pixels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v = v.draw_instance_predictions(outputs[&quot;instances&quot;].to(&quot;cpu&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv2_imshow(v.get_image()[:, :, ::-1])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-7.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-7-2e7f9a8cba8cc49ee8ab648cf18bc33b.png" width="819" height="540" class="img_ev3q"></p><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-8.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-8-9d5d0a41fa5a618be93561523b131930.png" width="819" height="614" class="img_ev3q"></p><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-9.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-9-67a9478fd72c9f64dc0f058a5395edb8.png" width="548" height="819" class="img_ev3q"></p><h1>Fine-tuning Chip Dataset</h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-the-data-1">Load the data<a class="hash-link" href="#load-the-data-1" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#get the dataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install -q kaggle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install -q kaggle-cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.environ[&#x27;KAGGLE_USERNAME&#x27;] = &quot;sparshag&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.environ[&#x27;KAGGLE_KEY&#x27;] = &quot;1b1f894d1fa6febe9676681b44ad807b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!kaggle datasets download -d tannergi/microcontroller-detection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!unzip microcontroller-detection.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="convert-dataset-into-detectron2s-standard-format-1">Convert dataset into Detectron2&#x27;s standard format<a class="hash-link" href="#convert-dataset-into-detectron2s-standard-format-1" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Registering the dataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from detectron2.structures import BoxMode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def get_microcontroller_dicts(csv_file, img_dir):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df = pd.read_csv(csv_file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df[&#x27;filename&#x27;] = df[&#x27;filename&#x27;].map(lambda x: img_dir+x)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    classes = [&#x27;Raspberry_Pi_3&#x27;, &#x27;Arduino_Nano&#x27;, &#x27;ESP8266&#x27;, &#x27;Heltec_ESP32_Lora&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df[&#x27;class_int&#x27;] = df[&#x27;class&#x27;].map(lambda x: classes.index(x))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataset_dicts = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for filename in df[&#x27;filename&#x27;].unique().tolist():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        height, width = cv2.imread(filename).shape[:2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;file_name&quot;] = filename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;height&quot;] = height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;width&quot;] = width</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        objs = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for index, row in df[(df[&#x27;filename&#x27;]==filename)].iterrows():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          obj= {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &#x27;bbox&#x27;: [row[&#x27;xmin&#x27;], row[&#x27;ymin&#x27;], row[&#x27;xmax&#x27;], row[&#x27;ymax&#x27;]],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &#x27;bbox_mode&#x27;: BoxMode.XYXY_ABS,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &#x27;category_id&#x27;: row[&#x27;class_int&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;iscrowd&quot;: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          objs.append(obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        record[&quot;annotations&quot;] = objs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dataset_dicts.append(record)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return dataset_dicts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">classes = [&#x27;Raspberry_Pi_3&#x27;, &#x27;Arduino_Nano&#x27;, &#x27;ESP8266&#x27;, &#x27;Heltec_ESP32_Lora&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for d in [&quot;train&quot;, &quot;test&quot;]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DatasetCatalog.register(&#x27;microcontroller/&#x27; + d, lambda d=d: get_microcontroller_dicts(&#x27;Microcontroller Detection/&#x27; + d + &#x27;_labels.csv&#x27;, &#x27;Microcontroller Detection/&#x27; + d+&#x27;/&#x27;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MetadataCatalog.get(&#x27;microcontroller/&#x27; + d).set(thing_classes=classes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">microcontroller_metadata = MetadataCatalog.get(&#x27;microcontroller/train&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="model-configuration-and-training-1">Model configuration and training<a class="hash-link" href="#model-configuration-and-training-1" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Train the model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg = get_cfg()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.merge_from_file(model_zoo.get_config_file(&quot;COCO-Detection/faster_rcnn_R_101_FPN_3x.yaml&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATASETS.TRAIN = (&#x27;microcontroller/train&#x27;,)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATASETS.TEST = ()   # no metrics implemented for this dataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATALOADER.NUM_WORKERS = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.WEIGHTS = model_zoo.get_checkpoint_url(&quot;COCO-Detection/faster_rcnn_R_101_FPN_3x.yaml&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.SOLVER.IMS_PER_BATCH = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.SOLVER.MAX_ITER = 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.ROI_HEADS.NUM_CLASSES = 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.makedirs(cfg.OUTPUT_DIR, exist_ok=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer = DefaultTrainer(cfg) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer.resume_or_load(resume=False)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer.train()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-10.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-10-8d5237190905a0e4fadc0b0ed691aef3.png" width="765" height="578" class="img_ev3q"></p><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-11.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-11-4da902dcc9cb45b630b4918e12ffd40b.png" width="640" height="480" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inference-and-visualization-1">Inference and Visualization<a class="hash-link" href="#inference-and-visualization-1" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.WEIGHTS = os.path.join(cfg.OUTPUT_DIR, &quot;model_final.pth&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.ROI_HEADS.SCORE_THRESH_TEST = 0.8   # set the testing threshold for this model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.DATASETS.TEST = (&#x27;microcontroller/test&#x27;, )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">predictor = DefaultPredictor(cfg)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_test = pd.read_csv(&#x27;Microcontroller Detection/test_labels.csv&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset_dicts = DatasetCatalog.get(&#x27;microcontroller/test&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for d in random.sample(dataset_dicts, 3):    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    im = cv2.imread(d[&quot;file_name&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    outputs = predictor(im)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v = Visualizer(im[:, :, ::-1], </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   metadata=microcontroller_metadata, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   scale=0.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v = v.draw_instance_predictions(outputs[&quot;instances&quot;].to(&quot;cpu&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv2_imshow(v.get_image()[:, :, ::-1])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="real-time-webcam-inference">Real-time Webcam inference<a class="hash-link" href="#real-time-webcam-inference" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from IPython.display import display, Javascript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from google.colab.output import eval_js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from base64 import b64decode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def take_photo(filename=&#x27;photo.jpg&#x27;, quality=0.8):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  js = Javascript(&#x27;&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    async function takePhoto(quality) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      const div = document.createElement(&#x27;div&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      const capture = document.createElement(&#x27;button&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      capture.textContent = &#x27;Capture&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      div.appendChild(capture);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      const video = document.createElement(&#x27;video&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      video.style.display = &#x27;block&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      const stream = await navigator.mediaDevices.getUserMedia({video: true});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      document.body.appendChild(div);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      div.appendChild(video);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      video.srcObject = stream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      await video.play();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Resize the output to fit the video element.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      google.colab.output.setIframeHeight(document.documentElement.scrollHeight, true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Wait for Capture to be clicked.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      await new Promise((resolve) =&gt; capture.onclick = resolve);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      const canvas = document.createElement(&#x27;canvas&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      canvas.width = video.videoWidth;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      canvas.height = video.videoHeight;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      canvas.getContext(&#x27;2d&#x27;).drawImage(video, 0, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stream.getVideoTracks()[0].stop();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      div.remove();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return canvas.toDataURL(&#x27;image/jpeg&#x27;, quality);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;&#x27;&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  display(js)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  data = eval_js(&#x27;takePhoto({})&#x27;.format(quality))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  binary = b64decode(data.split(&#x27;,&#x27;)[1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  with open(filename, &#x27;wb&#x27;) as f:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    f.write(binary)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return filename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from IPython.display import Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">try:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filename = take_photo()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(&#x27;Saved to {}&#x27;.format(filename))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Show the image which was just taken.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  display(Image(filename))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">except Exception as err:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Errors will be thrown if the user does not have a webcam or if they do not</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # grant the page permission to access it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print(str(err))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">model_path = &#x27;/content/output/model_final.pth&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config_path= model_zoo.get_config_file(&quot;COCO-Detection/faster_rcnn_R_101_FPN_3x.yaml&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg = get_cfg()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.merge_from_file(config_path)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.ROI_HEADS.SCORE_THRESH_TEST = 0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cfg.MODEL.WEIGHTS = model_path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">predictor = DefaultPredictor(cfg)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">im = cv2.imread(&#x27;photo.jpg&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">outputs = predictor(im)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v = Visualizer(im[:, :, ::-1], MetadataCatalog.get(cfg.DATASETS.TRAIN[0]), scale=1.2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v = v.draw_instance_predictions(outputs[&quot;instances&quot;].to(&quot;cpu&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cv2_imshow(v.get_image()[:, :, ::-1])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Fine-tuning on Face dataset</h1><p>The process is same. Here is the output.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-12.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-12-8624038661cf0ab9a13ffd35bcea2092.png" width="1353" height="550" class="img_ev3q"></p><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-13.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-13-9ef0b07eeb23c36fea216ff6d8776168.png" width="700" height="400" class="img_ev3q"></p><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-14.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-14-4eb13d5f04434cff475a78207b96071c.png" width="700" height="400" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="behind-the-scenes">Behind the scenes<a class="hash-link" href="#behind-the-scenes" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="/img/content-blog-raw-blog-detectron-2-untitled-15.png" src="/assets/images/content-blog-raw-blog-detectron-2-untitled-15-3bcd41db9aeb9c74ee059c1848fbc157.png" width="1071" height="563" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h3><ul><li><a href="https://medium.com/deepvisionguru/how-to-embed-detectron2-in-your-computer-vision-project-817f29149461" target="_blank" rel="noopener noreferrer">How to embed Detectron2 in your computer vision project - blogpost</a></li><li><a href="https://gilberttanner.com/blog/detectron2-train-a-instance-segmentation-model" target="_blank" rel="noopener noreferrer">Detectron2 Train a Instance Segmentation Model by Gilbert Tanner</a></li><li><a href="https://www.dlology.com/blog/how-to-train-detectron2-with-custom-coco-datasets/" target="_blank" rel="noopener noreferrer">How to train Detectron2 with Custom COCO Datasets - DLology</a></li><li><a href="https://towardsdatascience.com/character-recognition-and-segmentation-for-custom-data-using-detectron2-599de82b393c" target="_blank" rel="noopener noreferrer">Character Recognition and Segmentation For Custom Data Using Detectron2 - blogpost</a></li><li><a href="https://www.celantur.com/blog/panoptic-segmentation-in-detectron2/" target="_blank" rel="noopener noreferrer">Training models with Panoptic Segmentation in Detectron2</a></li><li><a href="https://www.kaggle.com/lewisgmorris/image-segmentation-using-detectron2" target="_blank" rel="noopener noreferrer">Image segmentation using Detectron2 - Kaggle</a></li><li><a href="https://towardsdatascience.com/a-beginners-guide-to-object-detection-and-computer-vision-with-facebook-s-detectron2-700b6273390e" target="_blank" rel="noopener noreferrer">A Beginner’s Guide To Object Detection And Computer Vision With Facebook’s Detectron2</a></li><li><a href="https://www.curiousily.com/posts/face-detection-on-custom-dataset-with-detectron2-in-python/" target="_blank" rel="noopener noreferrer">Face Detection on Custom Dataset with Detectron2 and PyTorch using Python</a></li><li><a href="https://www.notion.so/Detectron-2-d31ac9c14a8d4d9888882df14a4e0eee" target="_blank" rel="noopener noreferrer">My Experiment Notion</a></li><li><a href="https://colab.research.google.com/drive/16jcaJoc6bCFAQ96jDe2HwtXj7BMD_-m5" target="_blank" rel="noopener noreferrer">Official Colab</a></li><li><a href="https://research.fb.com/wp-content/uploads/2019/12/4.-detectron2.pdf" target="_blank" rel="noopener noreferrer">Official Slide</a></li><li><a href="https://github.com/facebookresearch/detectron2" target="_blank" rel="noopener noreferrer">Official Git</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/tool">tool</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/vision">vision</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/2021/10/01/tools-for-building-recommender-systems">Tools for building recommender systems</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/sparsh-ai.png" alt="Sparsh Agarwal"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Data Scientist &amp; Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-33bd5b09c80a9a5b7fc2800532c89fe6.png" width="1280" height="720" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recombee---recommendation-as-a-service-api">Recombee - Recommendation as a service API<a class="hash-link" href="#recombee---recommendation-as-a-service-api" title="Direct link to heading">​</a></h2><p>Recombee is a Recommender as a Service with easy integration and Admin UI. It can be used in many domains, for example in media (VoD, news …), e-commerce, job boards, aggregators or classifieds. Basically, it can be used in any domain with a catalog of <strong>items</strong> that can be interacted by <strong>users</strong>. The users can interact with the items in many ways: for example view them, rate them, bookmark them, purchase them, etc. Both items and users can have various properties (metadata) that are also used by the recommendation models.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-1.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-1-15d45c6a9a3b165fda99901c593e6df5.png" width="1241" height="992" class="img_ev3q"></p><p><a href="https://docs.recombee.com/tutorial.html" target="_blank" rel="noopener noreferrer">Here</a> is the official tutorial series to get started. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="amazon-personalize---self-service-platform-to-build-and-serve-recommenders">Amazon Personalize - Self-service Platform to build and serve recommenders<a class="hash-link" href="#amazon-personalize---self-service-platform-to-build-and-serve-recommenders" title="Direct link to heading">​</a></h2><p>Amazon Personalize is a fully managed machine learning service that goes beyond rigid static rule based recommendation systems and trains, tunes, and deploys custom ML models to deliver highly customized recommendations to customers across industries such as retail and media and entertainment.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-2.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-2-bbb5727247011c52a126ddc2f8de6135.png" width="1232" height="402" class="img_ev3q"></p><p>It covers 6 use-cases:</p><p><img loading="lazy" alt="Popular Use-cases" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-3-da7a1a934acc596135dbe5e304954eb0.png" width="1200" height="565" class="img_ev3q"></p><p>Popular Use-cases</p><p>Following are the hands-on tutorials:</p><ol><li><a href="https://github.com/data-science-on-aws/workshop/tree/937f6e4fed53fcc6c22bfac42c2c18a687317995/oreilly_book/02_usecases/personalize_recommendations" target="_blank" rel="noopener noreferrer">Data Science on AWS Workshop - Personalize Recommendations<strong>p</strong></a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/creating-a-recommendation-engine-using-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/creating-a-recommendation-engine-using-amazon-personalize/</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/omnichannel-personalization-with-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/omnichannel-personalization-with-amazon-personalize/</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/using-a-b-testing-to-measure-the-efficacy-of-recommendations-generated-by-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/using-a-b-testing-to-measure-the-efficacy-of-recommendations-generated-by-amazon-personalize/</a></li></ol><p>Also checkout these resources:</p><ol><li><a href="https://www.youtube.com/playlist?list=PLN7ADELDRRhiQB9QkFiZolioeJZb3wqPE" target="_blank" rel="noopener noreferrer">https://www.youtube.com/playlist?list=PLN7ADELDRRhiQB9QkFiZolioeJZb3wqPE</a></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-personalizer---an-api-based-service-with-reinforcement-learning-capability">Azure Personalizer - An API based service with Reinforcement learning capability<a class="hash-link" href="#azure-personalizer---an-api-based-service-with-reinforcement-learning-capability" title="Direct link to heading">​</a></h2><p>Azure Personalizer is a cloud-based API service that helps developers create rich, personalized experiences for each user of your app. It learns from customer&#x27;s real-time behavior, and uses reinforcement learning to select the best item (action) based on collective behavior and reward scores across all users. Actions are the content items, such as news articles, specific movies, or products. It takes a list of items (e.g. list of drop-down choices) and their context (e.g. Report Name, User Name, Time Zone) as input and returns the ranked list of items for the given context. While doing that, it also allows feedback submission regarding the relevance and efficiency of the ranking results returned by the service. The feedback (reward score) can be automatically calculated and submitted to the service based on the given personalization use case.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-4.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-4-b0966be33ec9922e5f7f503f9d860308.png" width="1624" height="881" class="img_ev3q"></p><p>You can use the Personalizer service to determine what product to suggest to shoppers or to figure out the optimal position for an advertisement. After the content is shown to the user, your application monitors the user&#x27;s reaction and reports a reward score back to the Personalizer service. This ensures continuous improvement of the machine learning model, and Personalizer&#x27;s ability to select the best content item based on the contextual information it receives. </p><p>Following are some of the interesting use cases of Azure Personalizer:</p><ol><li>Blog Recommender [<a href="https://youtu.be/fsn7hTOKXsY?list=PLN7ADELDRRhhHRu1tS3gmdeUfeQkG82k_&amp;t=1145" target="_blank" rel="noopener noreferrer">Video tutorial</a>, <a href="https://github.com/georgiakalyva/azure-personalizer-service" target="_blank" rel="noopener noreferrer">GitHub</a>]</li><li>Food Personalizer [<a href="https://youtu.be/A-8OfoWySHQ?list=PLN7ADELDRRhhHRu1tS3gmdeUfeQkG82k_&amp;t=1758" target="_blank" rel="noopener noreferrer">Video tutorial</a>, <a href="https://www.slideshare.net/SetuChokshi/introduction-to-reinforcement-learning-with-azure-personalizer-233272693" target="_blank" rel="noopener noreferrer">Slideshare</a>, <a href="https://pipinstall.me/introduction_to_azure_personalizer/" target="_blank" rel="noopener noreferrer">Code Blog</a>]</li><li>Coffee Personalizer [<a href="https://github.com/Azure-Samples/cognitive-services-personalizer-samples/tree/master/samples/azurenotebook" target="_blank" rel="noopener noreferrer">GitHub</a>, <a href="https://youtu.be/vkbIhX7xhcE?list=PLN7ADELDRRhhHRu1tS3gmdeUfeQkG82k_" target="_blank" rel="noopener noreferrer">Video tutorial</a>]</li><li>News Recommendation</li><li>Movie Recommendation</li><li>Product Recommendation</li><li><strong>Intent clarification &amp; disambiguation</strong>: help your users have a better experience when their intent is not clear by providing an option that is personalized.</li><li><strong>Default suggestions</strong> for menus &amp; options: have the bot suggest the most likely item in a personalized way as a first step, instead of presenting an impersonal menu or list of alternatives.</li><li><strong>Bot traits &amp; tone</strong>: for bots that can vary tone, verbosity, and writing style, consider varying these traits.</li><li><strong>Notification &amp; alert content</strong>: decide what text to use for alerts in order to engage users more.</li><li><strong>Notification &amp; alert timing</strong>: have personalized learning of when to send notifications to users to engage them more.</li><li>Dropdown Options - Different users of an application with manager privileges would see a list of reports that they can run. Before Personalizer was implemented, the list of dozens of reports was displayed in alphabetical order, requiring most of the managers to scroll through the lengthy list to find the report they needed. This created a poor user experience for daily users of the reporting system, making for a good use case for Personalizer. The tooling learned from the user behavior and began to rank frequently run reports on the top of the dropdown list. Frequently run reports would be different for different users, and would change over time for each manager as they get assigned to different projects. This is exactly the situation where Personalizer’s reward score-based learning models come into play.</li><li>Projects in Timesheet - Every employee in the company logs a daily timesheet listing all of the projects the user is assigned to. It also lists other projects, such as overhead. Depending upon the employee project allocations, his or her timesheet table could have few to a couple of dozen active projects listed. Even though the employee is assigned to several projects, particularly at lead and manager levels, they don’t log time in more than 2 to 3 projects for a few weeks to months.<ol><li>Reward Score Calculation</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="google-recommendation---recommender-service-from-google">Google Recommendation - Recommender Service from Google<a class="hash-link" href="#google-recommendation---recommender-service-from-google" title="Direct link to heading">​</a></h2><p><img loading="lazy" src="https://cloudx-bricks-prod-bucket.storage.googleapis.com/6a0d4afb1778e55d54cb7d66382a4b25f8748a50a93f3c3403d2a835aa166f3d.svg" alt="https://cloudx-bricks-prod-bucket.storage.googleapis.com/6a0d4afb1778e55d54cb7d66382a4b25f8748a50a93f3c3403d2a835aa166f3d.svg" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="abacusai---self-service-platform-at-cheaper-price"><a href="http://abacus.ai" target="_blank" rel="noopener noreferrer">Abacus.ai</a> - Self-service Platform at cheaper price<a class="hash-link" href="#abacusai---self-service-platform-at-cheaper-price" title="Direct link to heading">​</a></h2><p>It uses multi-objective, real-time recommendations models and provides 4 use-cases for fasttrack train-&amp;-deploy process - Personalized recommendations, personalized search, related items and real-time feed recommendations.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-5.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-5-c0db5366214db1b5ddba15c3046274a1.png" width="1536" height="728" class="img_ev3q"></p><p>Here is the hands-on video tutorial:</p><p><a href="https://youtu.be/7hTKL73f2yA" target="_blank" rel="noopener noreferrer">https://youtu.be/7hTKL73f2yA</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nvidia-merlin---toolkit-with-gpu-capabilities">Nvidia Merlin - Toolkit with GPU capabilities<a class="hash-link" href="#nvidia-merlin---toolkit-with-gpu-capabilities" title="Direct link to heading">​</a></h2><p>Merlin empowers data scientists, machine learning engineers, and researchers to build high-performing recommenders at scale. Merlin includes tools that democratize building deep learning recommenders by addressing common ETL, training, and inference challenges. Each stage of the Merlin pipeline is optimized to support hundreds of terabytes of data, all accessible through easy-to-use APIs. With Merlin, better predictions than traditional methods and increased click-through rates are within reach.</p><p><img loading="lazy" alt="End-to-end recommender system architecture. FE: feature engineering; PP: preprocessing; ETL: extract-transform-load." src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-6-bab580822491ea307cdcadbf0494cd58.png" width="625" height="401" class="img_ev3q"></p><p>End-to-end recommender system architecture. FE: feature engineering; PP: preprocessing; ETL: extract-transform-load.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-7.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-7-72ce5f1a35b17b1f258151d077e546d5.png" width="954" height="533" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tfrs---open-source-recommender-library-built-on-top-of-tensorflow">TFRS - Open-source Recommender library built on top of Tensorflow<a class="hash-link" href="#tfrs---open-source-recommender-library-built-on-top-of-tensorflow" title="Direct link to heading">​</a></h2><p>Built with TensorFlow 2.x, TFRS makes it possible to:</p><ul><li>Build and evaluate flexible <strong><a href="https://research.google/pubs/pub48840/" target="_blank" rel="noopener noreferrer">candidate nomination models</a></strong>;</li><li>Freely incorporate item, user, and context <strong><a href="https://tensorflow.org/recommenders/examples/featurization" target="_blank" rel="noopener noreferrer">information</a></strong> into recommendation models;</li><li>Train <strong><a href="https://tensorflow.org/recommenders/examples/multitask" target="_blank" rel="noopener noreferrer">multi-task models</a></strong> that jointly optimize multiple recommendation objectives;</li><li>Efficiently serve the resulting models using <strong><a href="https://www.tensorflow.org/tfx/guide/serving" target="_blank" rel="noopener noreferrer">TensorFlow Serving</a></strong>.</li></ul><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-8.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-8-933d52e40642395d74e8349dc435d525.png" width="1200" height="675" class="img_ev3q"></p><p>Following is a series of official tutorial notebooks:-</p><p><a href="https://www.tensorflow.org/recommenders/examples/quickstart" target="_blank" rel="noopener noreferrer">TensorFlow Recommenders: Quickstart</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="elliot---an-end-to-end-framework-good-for-recommender-system-experiments">Elliot - An end-to-end framework good for recommender system experiments<a class="hash-link" href="#elliot---an-end-to-end-framework-good-for-recommender-system-experiments" title="Direct link to heading">​</a></h2><p><a href="https://elliot.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Elliot</a> is a comprehensive recommendation framework that aims to run and reproduce an entire experimental pipeline by processing a simple configuration file. The framework loads, filters, and splits the data considering a vast set of strategies (13 splitting methods and 8 filtering approaches, from temporal training-test splitting to nested K-folds Cross-Validation). Elliot optimizes hyperparameters (51 strategies) for several recommendation algorithms (50), selects the best models, compares them with the baselines providing intra-model statistics, computes metrics (36) spanning from accuracy to beyond-accuracy, bias, and fairness, and conducts statistical analysis (Wilcoxon and Paired t-test). The aim is to provide the researchers with a tool to ease (and make them reproducible) all the experimental evaluation phases, from data reading to results collection.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-9.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-9-ac36100c32df3a360e3d4e338e476986.png" width="1280" height="611" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recbole---another-framework-good-for-recommender-system-model-experiments">RecBole - Another framework good for recommender system model experiments<a class="hash-link" href="#recbole---another-framework-good-for-recommender-system-model-experiments" title="Direct link to heading">​</a></h2><p>RecBole is developed based on Python and PyTorch for reproducing and developing recommendation algorithms in a unified, comprehensive and efficient framework for research purpose. It can be installed from pip, Conda and source, and easy to use. It includes 65 recommendation algorithms, covering four major categories: General Recommendation, Sequential Recommendation, Context-aware Recommendation, and Knowledge-based Recommendation, which can support the basic research in recommender systems.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-10.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-10-2ff1939da16912cf7721faab10905964.png" width="421" height="120" class="img_ev3q"></p><p>Features:</p><ul><li><strong>General and extensible data structure</strong>We deign general and extensible data structures to unify the formatting and usage of various recommendation datasets.</li><li><strong>Comprehensive benchmark models and datasets</strong>We implement 65 commonly used recommendation algorithms, and provide the formatted copies of 28 recommendation datasets.</li><li><strong>Efficient GPU-accelerated execution</strong>We design many tailored strategies in the GPU environment to enhance the efficiency of our library.</li><li><strong>Extensive and standard evaluation protocols</strong>We support a series of commonly used evaluation protocols or settings for testing and comparing recommendation algorithms.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="microsoft-recommenders---a-powerful-set-of-tools-for-building-high-quality-recommender-system-at-low-cost-highly-recommended">Microsoft Recommenders - A powerful set of tools for building high-quality recommender system at low-cost <em>(highly recommended)</em><a class="hash-link" href="#microsoft-recommenders---a-powerful-set-of-tools-for-building-high-quality-recommender-system-at-low-cost-highly-recommended" title="Direct link to heading">​</a></h2><p>The Microsoft Recommenders repository is an open source collection of python utilities and Jupyter notebooks to help accelerate the process of designing, evaluating, and deploying recommender systems. The repository was initially formed by data scientists at Microsoft to consolidate common tools and best practices developed from working on recommender systems in various industry settings. The goal of the tools and notebooks is to show examples of how to effectively build, compare, and then deploy the best recommender solution for a given scenario. Contributions from the community have brought in new algorithm implementations and code examples covering multiple aspects of working with recommendation algorithms.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-11.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-11-ef09c0b67a5644c593d818afc689edad.png" width="522" height="246" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="surprise---an-open-source-library-with-easy-api-and-powerful-models">Surprise - An open-source library with easy api and powerful models<a class="hash-link" href="#surprise---an-open-source-library-with-easy-api-and-powerful-models" title="Direct link to heading">​</a></h2><p><a href="http://surpriselib.com/" target="_blank" rel="noopener noreferrer">Surprise</a> is a Python <a href="https://www.scipy.org/scikits.html" target="_blank" rel="noopener noreferrer">scikit</a> for building and analyzing recommender systems that deal with explicit rating data.</p><p><a href="http://surpriselib.com/" target="_blank" rel="noopener noreferrer">Surprise</a> <strong>was designed with the following purposes in mind</strong>:</p><ul><li>Give users perfect control over their experiments. To this end, a strong emphasis is laid on <a href="http://surprise.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener noreferrer">documentation</a>, which we have tried to make as clear and precise as possible by pointing out every detail of the algorithms.</li><li>Alleviate the pain of <a href="http://surprise.readthedocs.io/en/stable/getting_started.html#load-a-custom-dataset" target="_blank" rel="noopener noreferrer">Dataset handling</a>. Users can use both <em>built-in</em> datasets (<a href="http://grouplens.org/datasets/movielens/" target="_blank" rel="noopener noreferrer">Movielens</a>, <a href="http://eigentaste.berkeley.edu/dataset/" target="_blank" rel="noopener noreferrer">Jester</a>), and their own <em>custom</em> datasets.</li><li>Provide various ready-to-use <a href="http://surprise.readthedocs.io/en/stable/prediction_algorithms_package.html" target="_blank" rel="noopener noreferrer">prediction algorithms</a> such as <a href="http://surprise.readthedocs.io/en/stable/basic_algorithms.html" target="_blank" rel="noopener noreferrer">baseline algorithms</a>, <a href="http://surprise.readthedocs.io/en/stable/knn_inspired.html" target="_blank" rel="noopener noreferrer">neighborhood methods</a>, matrix factorization-based ( <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVD" target="_blank" rel="noopener noreferrer">SVD</a>, <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#unbiased-note" target="_blank" rel="noopener noreferrer">PMF</a>, <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVDpp" target="_blank" rel="noopener noreferrer">SVD++</a>, <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.NMF" target="_blank" rel="noopener noreferrer">NMF</a>), and <a href="http://surprise.readthedocs.io/en/stable/prediction_algorithms_package.html" target="_blank" rel="noopener noreferrer">many others</a>. Also, various <a href="http://surprise.readthedocs.io/en/stable/similarities.html" target="_blank" rel="noopener noreferrer">similarity measures</a> (cosine, MSD, pearson…) are built-in.</li><li>Make it easy to implement <a href="http://surprise.readthedocs.io/en/stable/building_custom_algo.html" target="_blank" rel="noopener noreferrer">new algorithm ideas</a>.</li><li>Provide tools to <a href="http://surprise.readthedocs.io/en/stable/model_selection.html" target="_blank" rel="noopener noreferrer">evaluate</a>, <a href="http://nbviewer.jupyter.org/github/NicolasHug/Surprise/tree/master/examples/notebooks/KNNBasic_analysis.ipynb/" target="_blank" rel="noopener noreferrer">analyse</a> and <a href="http://nbviewer.jupyter.org/github/NicolasHug/Surprise/blob/master/examples/notebooks/Compare.ipynb" target="_blank" rel="noopener noreferrer">compare</a> the algorithms’ performance. Cross-validation procedures can be run very easily using powerful CV iterators (inspired by <a href="http://scikit-learn.org/" target="_blank" rel="noopener noreferrer">scikit-learn</a> excellent tools), as well as <a href="http://surprise.readthedocs.io/en/stable/getting_started.html#tune-algorithm-parameters-with-gridsearchcv" target="_blank" rel="noopener noreferrer">exhaustive search over a set of parameters</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="spotlight---another-open-source-library">Spotlight - Another open-source library<a class="hash-link" href="#spotlight---another-open-source-library" title="Direct link to heading">​</a></h2><p>Spotlight uses PyTorch to build both deep and shallow recommender models. By providing both a slew of building blocks for loss functions (various pointwise and pairwise ranking losses), representations (shallow factorization representations, deep sequence models), and utilities for fetching (or generating) recommendation datasets, it aims to be a tool for rapid exploration and prototyping of new recommender models.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-12.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-12-5c6173d316d62401ecc35f324f47f7ba.png" width="1020" height="245" class="img_ev3q"></p><p><a href="https://github.com/maciejkula/spotlight/tree/master/examples" target="_blank" rel="noopener noreferrer">Here</a> is a series of hands-on tutorials to get started.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="vowpal-wabbit---library-with-reinforcement-learning-features">Vowpal Wabbit - library with reinforcement learning features<a class="hash-link" href="#vowpal-wabbit---library-with-reinforcement-learning-features" title="Direct link to heading">​</a></h2><p>Vowpal Wabbit is an open source machine learning library, extensively used by industry, and is the first public terascale learning system. It provides fast, scalable machine learning and has unique capabilities such as learning to search, active learning, contextual memory, and extreme multiclass learning. It has a focus on reinforcement learning and provides production ready implementations of Contextual Bandit algorithms. It was developed originally at Yahoo! Research, and currently at Microsoft Research. Vowpal Wabbit sees significant innovation as a research to production vehicle for Microsoft Research.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-13.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-13-5a6e5b81832dd904c8ac5120433e67c3.png" width="369" height="345" class="img_ev3q"></p><p>For most applications, collaborative filtering yields satisfactory results for item recommendations; there are however several issues that arise that might make it difficult to scale up a recommender system.</p><ul><li>The number of features can grow quite large, and given the usual sparsity of consumption datasets, collaborative filtering needs every single feature and datapoint available.</li><li>For new data points, the whole model has to be re-trained</li></ul><p>Vowpal Wabbit’s matrix factorization capabilities can be used to build a recommender that is similar in spirit to collaborative filtering but that avoids the pitfalls that we mentioned before.</p><p>Following are the three introductory hands-on tutorials on building recommender systems with vowpal wabbit:</p><ol><li><a href="https://github.com/microsoft/recommenders/blob/main/examples/02_model_content_based_filtering/vowpal_wabbit_deep_dive.ipynb" target="_blank" rel="noopener noreferrer">Vowpal Wabbit Deep Dive - A Content-based Recommender System using Microsoft Recommender Library</a></li><li><a href="https://vowpalwabbit.org/tutorials/cb_simulation.html" target="_blank" rel="noopener noreferrer">Simulating Content Personalization with Contextual Bandits</a></li><li><a href="https://samuel-guedj.medium.com/vowpal-wabbit-the-magic-58b7f1d8e39c" target="_blank" rel="noopener noreferrer">Vowpal Wabbit, The Magic Recommender System!</a></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dlrm---an-open-source-scalable-model-from-facebooks-ai-team-build-on-top-of-pytorch">DLRM - An open-source scalable model from Facebook&#x27;s AI team, build on top of PyTorch<a class="hash-link" href="#dlrm---an-open-source-scalable-model-from-facebooks-ai-team-build-on-top-of-pytorch" title="Direct link to heading">​</a></h2><p>DLRM advances on other models by combining principles from both collaborative filtering and predictive analytics-based approaches, which enables it to work efficiently with production-scale data and provide state-of-art results.</p><p>In the DLRM model, categorical features are processed using embeddings, while continuous features are processed with a bottom multilayer perceptron (MLP). Then, second-order interactions of different features are computed explicitly. Finally, the results are processed with a top MLP and fed into a sigmoid function in order to give a probability of a click.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-14.png" src="/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-14-66bcd9a8782a87919f0f6dcbb1a18943.png" width="2000" height="1126" class="img_ev3q"></p><p>Following are the hands-on tutorials:</p><ol><li><a href="https://nbviewer.jupyter.org/github/gotorehanahmad/Recommendation-Systems/blob/master/dlrm/dlrm_main.ipynb" target="_blank" rel="noopener noreferrer">https://nbviewer.jupyter.org/github/gotorehanahmad/Recommendation-Systems/blob/master/dlrm/dlrm_main.ipynb</a></li><li><a href="https://nbviewer.jupyter.org/github/mabeckers/dlrm/blob/new_dataset/Train_DLRM_Digix.ipynb" target="_blank" rel="noopener noreferrer">Training Facebook&#x27;s DLRM on the digix dataset</a></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ol><li><a href="https://elliot.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">https://elliot.readthedocs.io/en/latest/</a></li><li><a href="https://vowpalwabbit.org/index.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/index.html</a></li><li><a href="https://abacus.ai/user_eng" target="_blank" rel="noopener noreferrer">https://abacus.ai/user_eng</a></li><li><a href="https://azure.microsoft.com/en-in/services/cognitive-services/personalizer/" target="_blank" rel="noopener noreferrer">https://azure.microsoft.com/en-in/services/cognitive-services/personalizer/</a></li><li><a href="https://aws.amazon.com/personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/personalize/</a></li><li><a href="https://github.com/facebookresearch/dlrm" target="_blank" rel="noopener noreferrer">https://github.com/facebookresearch/dlrm</a></li><li><a href="https://www.tensorflow.org/recommenders" target="_blank" rel="noopener noreferrer">https://www.tensorflow.org/recommenders</a></li><li><a href="https://magento.com/products/product-recommendations" target="_blank" rel="noopener noreferrer">https://magento.com/products/product-recommendations</a></li><li><a href="https://cloud.google.com/recommendations" target="_blank" rel="noopener noreferrer">https://cloud.google.com/recommendations</a></li><li><a href="https://www.recombee.com/" target="_blank" rel="noopener noreferrer">https://www.recombee.com/</a></li><li><a href="https://recbole.io/" target="_blank" rel="noopener noreferrer">https://recbole.io/</a></li><li><a href="https://github.com/microsoft/recommenders" target="_blank" rel="noopener noreferrer">https://github.com/microsoft/recommenders</a></li><li><a href="http://surpriselib.com/" target="_blank" rel="noopener noreferrer">http://surpriselib.com/</a></li><li><a href="https://github.com/maciejkula/spotlight" target="_blank" rel="noopener noreferrer">https://github.com/maciejkula/spotlight</a></li><li><a href="https://vowpalwabbit.org/tutorials/contextual_bandits.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/tutorials/contextual_bandits.html</a></li><li><a href="https://github.com/VowpalWabbit/vowpal_wabbit/wiki" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/vowpal_wabbit/wiki</a></li><li><a href="https://vowpalwabbit.org/tutorials/cb_simulation.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/tutorials/cb_simulation.html</a></li><li><a href="https://vowpalwabbit.org/rlos/2021/projects.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/rlos/2021/projects.html</a></li><li><a href="https://vowpalwabbit.org/rlos/2020/projects.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/rlos/2020/projects.html</a></li><li><a href="https://getstream.io/blog/recommendations-activity-streams-vowpal-wabbit/" target="_blank" rel="noopener noreferrer">https://getstream.io/blog/recommendations-activity-streams-vowpal-wabbit/</a></li><li><a href="https://samuel-guedj.medium.com/vowpal-wabbit-the-magic-58b7f1d8e39c" target="_blank" rel="noopener noreferrer">https://samuel-guedj.medium.com/vowpal-wabbit-the-magic-58b7f1d8e39c</a></li><li><a href="https://vowpalwabbit.org/neurips2019/" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/neurips2019/</a></li><li><a href="https://github.com/VowpalWabbit/neurips2019" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/neurips2019</a></li><li><a href="https://getstream.io/blog/introduction-contextual-bandits/" target="_blank" rel="noopener noreferrer">https://getstream.io/blog/introduction-contextual-bandits/</a></li><li><a href="https://www.youtube.com/watch?v=CeOcNK1xSSA&amp;t=72s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=CeOcNK1xSSA&amp;t=72s</a></li><li><a href="https://vowpalwabbit.org/blog/rlos-fest-2021.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/blog/rlos-fest-2021.html</a></li><li><a href="https://github.com/VowpalWabbit/workshop" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/workshop</a></li><li><a href="https://github.com/VowpalWabbit/workshop/tree/master/aiNextCon2019" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/workshop/tree/master/aiNextCon2019</a></li><li><a href="https://www.ais.com/azure-cognitive-services-personalizer-part-one/" target="_blank" rel="noopener noreferrer">Blog post by Nasir Mirza. Azure Cognitive Services Personalizer: Part One. Oct, 2019.</a></li><li><a href="https://www.ais.com/azure-cognitive-services-personalizer-part-two/" target="_blank" rel="noopener noreferrer">Blog post by Nasir Mirza. Azure Cognitive Services Personalizer: Part Two. Oct, 2019.</a></li><li><a href="https://www.ais.com/azure-cognitive-services-personalizer-part-three/" target="_blank" rel="noopener noreferrer">Blog post by Nasir Mirza. Azure Cognitive Services Personalizer: Part Three. Dec, 2019.</a></li><li><a href="https://docs.microsoft.com/en-us/azure/cognitive-services/personalizer/what-is-personalizer" target="_blank" rel="noopener noreferrer">Microsoft Azure Personalizer Official Documentation. Oct, 2020.</a></li><li><a href="https://personalizationdemo.azurewebsites.net/" target="_blank" rel="noopener noreferrer">Personalizer demo.</a></li><li><a href="https://azure.microsoft.com/en-in/services/cognitive-services/personalizer/#faqs" target="_blank" rel="noopener noreferrer">Official Page.</a></li><li><a href="https://www.linkedin.com/pulse/get-hands-azure-personalizer-api-jake-wang/" target="_blank" rel="noopener noreferrer">Blog Post by Jake Wong. Get hands on with the Azure Personalizer API. Aug, 2019.</a></li><li><a href="https://enefitit.medium.com/we-tested-azure-personalizer-heres-what-you-can-expect-8c5ec074a28e" target="_blank" rel="noopener noreferrer">Medium Post.</a></li><li><a href="https://www.valoremreply.com/post/azure-personalizer/" target="_blank" rel="noopener noreferrer">Blog Post.</a></li><li><a href="https://github.com/Azure-Samples/cognitive-services-personalizer-samples" target="_blank" rel="noopener noreferrer">Git Repo.</a></li><li><a href="https://youtu.be/7hTKL73f2yA" target="_blank" rel="noopener noreferrer">https://youtu.be/7hTKL73f2yA</a></li><li><a href="https://abacus.ai/blog/2020/03/31/deep-learning-based-recommendation-systems/#:~:text=Deep%2DLearning%20Based%20Recommendation%20Systems%20%E2%80%94%20Learning%20AI,-By%20Abacus.AI&amp;text=Deep%20Learning%20(DL)%20has%20had,of%20Recommender%20Systems%20(RS)." target="_blank" rel="noopener noreferrer">Deep-Learning Based Recommendation Systems — Learning AI</a></li><li><a href="https://abacus.ai/blog/2020/12/11/evaluating-deep-learning-models-recommender-systems/" target="_blank" rel="noopener noreferrer">Evaluating Deep Learning Models with Abacus.AI – Recommendation Systems</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/pioneering-personalized-user-experiences-at-stockx-with-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/pioneering-personalized-user-experiences-at-stockx-with-amazon-personalize/</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/category/artificial-intelligence/amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/category/artificial-intelligence/amazon-personalize/</a></li><li><a href="https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Build_a_content-recommendation_engine_with_Amazon_Personalize_AIM304-R1.pdf" target="_blank" rel="noopener noreferrer">https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Build_a_content-recommendation_engine_with_Amazon_Personalize_AIM304-R1.pdf</a></li><li><a href="https://aws.amazon.com/blogs/aws/amazon-personalize-real-time-personalization-and-recommendation-for-everyone/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/aws/amazon-personalize-real-time-personalization-and-recommendation-for-everyone/</a></li><li><a href="https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Accelerate_experimentation_with_personalization_models_AIM424-R1.pdf" target="_blank" rel="noopener noreferrer">https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Accelerate_experimentation_with_personalization_models_AIM424-R1.pdf</a></li><li><a href="https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Personalized_user_engagement_with_machine_learning_AIM346-R1.pdf" target="_blank" rel="noopener noreferrer">https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Personalized_user_engagement_with_machine_learning_AIM346-R1.pdf</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-samples" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-samples</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-automated-retraining" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-automated-retraining</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-ingestion-pipeline" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-ingestion-pipeline</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-monitor" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-monitor</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-data-conversion-pipeline" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-data-conversion-pipeline</a></li><li><a href="https://github.com/james-jory/segment-personalize-workshop" target="_blank" rel="noopener noreferrer">https://github.com/james-jory/segment-personalize-workshop</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-samples/tree/master/next_steps/workshops/POC_in_a_box" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-samples/tree/master/next_steps/workshops/POC_in_a_box</a></li><li><a href="https://github.com/Imagination-Media/aws-personalize-magento2" target="_blank" rel="noopener noreferrer">https://github.com/Imagination-Media/aws-personalize-magento2</a></li><li><a href="https://github.com/awslabs/amazon-personalize-optimizer-using-amazon-pinpoint-events" target="_blank" rel="noopener noreferrer">https://github.com/awslabs/amazon-personalize-optimizer-using-amazon-pinpoint-events</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-with-aws-glue-sample-dataset" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-with-aws-glue-sample-dataset</a></li><li><a href="https://github.com/awsdocs/amazon-personalize-developer-guide" target="_blank" rel="noopener noreferrer">https://github.com/awsdocs/amazon-personalize-developer-guide</a></li><li><a href="https://github.com/chrisking/NetflixPersonalize" target="_blank" rel="noopener noreferrer">https://github.com/chrisking/NetflixPersonalize</a></li><li><a href="https://github.com/aws-samples/retail-demo-store" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/retail-demo-store</a></li><li><a href="https://github.com/aws-samples/personalize-data-science-sdk-workflow" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/personalize-data-science-sdk-workflow</a></li><li><a href="https://github.com/apac-ml-tfc/personalize-poc" target="_blank" rel="noopener noreferrer">https://github.com/apac-ml-tfc/personalize-poc</a></li><li><a href="https://github.com/dalacan/personalize-batch-recommendations" target="_blank" rel="noopener noreferrer">https://github.com/dalacan/personalize-batch-recommendations</a></li><li><a href="https://github.com/harunobukameda/Amazon-Personalize-Handson" target="_blank" rel="noopener noreferrer">https://github.com/harunobukameda/Amazon-Personalize-Handson</a></li><li><a href="https://www.sagemakerworkshop.com/personalize/" target="_blank" rel="noopener noreferrer">https://www.sagemakerworkshop.com/personalize/</a></li><li><a href="https://github.com/lmorri/vodpocinabox" target="_blank" rel="noopener noreferrer">https://github.com/lmorri/vodpocinabox</a></li><li><a href="https://github.com/awslabs/unicornflix" target="_blank" rel="noopener noreferrer">https://github.com/awslabs/unicornflix</a></li><li><a href="https://www.youtube.com/watch?v=r9J3UZmddC4&amp;t=966s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=r9J3UZmddC4&amp;t=966s</a></li><li><a href="https://www.youtube.com/watch?v=kTufCK76Yus&amp;t=1436s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=kTufCK76Yus&amp;t=1436s</a></li><li><a href="https://www.youtube.com/watch?v=hY_XzglTkak&amp;t=66s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=hY_XzglTkak&amp;t=66s</a></li><li><a href="https://business.adobe.com/lv/summit/2020/adobe-sensei-powers-magento-product-recommendations.html" target="_blank" rel="noopener noreferrer">https://business.adobe.com/lv/summit/2020/adobe-sensei-powers-magento-product-recommendations.html</a></li><li><a href="https://magento.com/products/product-recommendations" target="_blank" rel="noopener noreferrer">https://magento.com/products/product-recommendations</a></li><li><a href="https://docs.magento.com/user-guide/marketing/product-recommendations.html" target="_blank" rel="noopener noreferrer">https://docs.magento.com/user-guide/marketing/product-recommendations.html</a></li><li><a href="https://vod.webqem.com/detail/videos/magento-commerce/video/6195503645001/magento-commerce---product-recommendations?autoStart=true&amp;page=1" target="_blank" rel="noopener noreferrer">https://vod.webqem.com/detail/videos/magento-commerce/video/6195503645001/magento-commerce---product-recommendations?autoStart=true&amp;page=1</a></li><li><a href="https://blog.adobe.com/en/publish/2020/11/23/new-ai-capabilities-for-magento-commerce-improve-retail.html#gs.yw6mtq" target="_blank" rel="noopener noreferrer">https://blog.adobe.com/en/publish/2020/11/23/new-ai-capabilities-for-magento-commerce-improve-retail.html#gs.yw6mtq</a></li><li><a href="https://developers.google.com/recommender/docs/reference/rest" target="_blank" rel="noopener noreferrer">https://developers.google.com/recommender/docs/reference/rest</a></li><li><a href="https://www.youtube.com/watch?v=nY5U0uQZRyU&amp;t=6s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=nY5U0uQZRyU&amp;t=6s</a></li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/recsys">recsys</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/tool">tool</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Bootcamp. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1db50233.js"></script>
<script src="/assets/js/main.c578965a.js"></script>
</body>
</html>